// Jest Snapshot v1, https://jestjs.io/docs/snapshot-testing

exports[`wp-post mutation helpers queues helpers in contract order with stable output: helper-programs 1`] = `
[
  {
    "helper": "sync-meta",
    "statements": [
      "class MutationHelpers",
      "{",
      "        private function syncBookMeta( int $post_id, WP_REST_Request $request ): void",
      "        {",
      "                $subtitleMeta = $request->get_param( 'subtitle' );",
      "                if ( null !== $subtitleMeta ) {",
      "                        $subtitleMeta = is_string( $subtitleMeta ) ? $subtitleMeta : (string) $subtitleMeta;",
      "                        update_post_meta( $post_id, 'subtitle', $subtitleMeta );",
      "                }",
      "        }",
      "}",
    ],
  },
  {
    "helper": "sync-taxonomies",
    "statements": [
      "class MutationHelpers",
      "{",
      "        private function syncBookTaxonomies( int $post_id, WP_REST_Request $request )",
      "        {",
      "                $result = true;",
      "                $categoryTerms = $request->get_param( 'category' );",
      "                if ( null !== $categoryTerms ) {",
      "                        if ( ! is_array( $categoryTerms ) ) {",
      "                                $categoryTerms = array( $categoryTerms );",
      "                        }",
      "                        $categoryTerms = array_filter( array_map( 'intval', (array) $categoryTerms ) );",
      "                        $result = wp_set_object_terms(",
      "                                $post_id,",
      "                                $categoryTerms,",
      "                                'category',",
      "                                false",
      "                        );",
      "                        if ( is_wp_error( $result ) ) {",
      "                                return $result;",
      "                        }",
      "                }",
      "                return $result;",
      "        }",
      "}",
    ],
  },
  {
    "helper": "prepare-response",
    "statements": [
      "class MutationHelpers",
      "{",
      "        private function prepareBookResponse( WP_Post $post, WP_REST_Request $request ): array",
      "        {",
      "                $data = array(",
      "                        'id' => (int) $post->ID,",
      "                        'status' => (string) $post->post_status,",
      "                );",
      "                $data['title'] = (string) $post->post_title;",
      "                $data['content'] = (string) $post->post_content;",
      "                $subtitleMeta = get_post_meta( $post->ID, 'subtitle', true );",
      "                        $subtitleMeta = is_string( $subtitleMeta ) ? $subtitleMeta : (string) $subtitleMeta;",
      "                $data['subtitle'] = $subtitleMeta;",
      "                $categoryTerms = wp_get_object_terms( $post->ID, 'category', array( 'fields' => 'ids' ) );",
      "                if ( is_wp_error( $categoryTerms ) ) {",
      "                        $categoryTerms = array();",
      "                }",
      "                $categoryTerms = array_map( 'intval', (array) $categoryTerms );",
      "                $data['category'] = $categoryTerms;",
      "                return $data;",
      "        }",
      "}",
    ],
  },
]
`;

exports[`wp-post mutation route builders emits create route body with macros in expected order: create-route 1`] = `
[
  {
    "attributes": {},
    "declares": [
      {
        "attributes": {},
        "key": {
          "attributes": {},
          "name": "strict_types",
          "nodeType": "Identifier",
        },
        "nodeType": "DeclareItem",
        "value": {
          "attributes": {},
          "nodeType": "Scalar_LNumber",
          "value": 1,
        },
      },
    ],
    "nodeType": "Stmt_Declare",
    "stmts": null,
  },
  {
    "attributes": {},
    "name": {
      "attributes": {},
      "nodeType": "Name",
      "parts": [
        "Demo",
        "Rest",
      ],
    },
    "nodeType": "Stmt_Namespace",
    "stmts": [
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:BEGIN AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
      {
        "attrGroups": [],
        "attributes": {},
        "extends": null,
        "flags": 0,
        "implements": [],
        "name": {
          "attributes": {},
          "name": "MutationHarness",
          "nodeType": "Identifier",
        },
        "namespacedName": null,
        "nodeType": "Stmt_Class",
        "stmts": [
          {
            "attrGroups": [],
            "attributes": {},
            "byRef": false,
            "flags": 0,
            "name": {
              "attributes": {},
              "name": "handle",
              "nodeType": "Identifier",
            },
            "nodeType": "Stmt_ClassMethod",
            "params": [],
            "returnType": null,
            "stmts": [
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "getBookPostType",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post_type",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "items": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "key": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "post_type",
                        },
                        "nodeType": "Expr_ArrayItem",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post_type",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "nodeType": "Expr_Array",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post_data",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation status-validation",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:status normalise",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "status",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "get_param",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "request",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "status",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "status",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "normaliseBookStatus",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "dim": {
                      "attributes": {},
                      "nodeType": "Scalar_String",
                      "value": "post_status",
                    },
                    "nodeType": "Expr_ArrayDimFetch",
                    "var": {
                      "attributes": {},
                      "name": "post_data",
                      "nodeType": "Expr_Variable",
                    },
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post_data",
                          "nodeType": "Expr_Variable",
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "nodeType": "Name",
                            "parts": [
                              "true",
                            ],
                          },
                          "nodeType": "Expr_ConstFetch",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "wp_insert_post",
                      ],
                    },
                    "nodeType": "Expr_FuncCall",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post_id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "post_id",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "nodeType": "Name",
                    "parts": [
                      "is_wp_error",
                    ],
                  },
                  "nodeType": "Expr_FuncCall",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "post_id",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "nodeType": "Scalar_LNumber",
                    "value": 0,
                  },
                  "nodeType": "Expr_BinaryOp_Identical",
                  "right": {
                    "attributes": {},
                    "name": "post_id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_create_failed",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Unable to create Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 500,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation sync-meta",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:meta update",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "post_id",
                        "nodeType": "Expr_Variable",
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "request",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "name": "syncBookMeta",
                    "nodeType": "Identifier",
                  },
                  "nodeType": "Expr_MethodCall",
                  "var": {
                    "attributes": {},
                    "name": "this",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation sync-taxonomies",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:taxonomies update",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post_id",
                          "nodeType": "Expr_Variable",
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "request",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "syncBookTaxonomies",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "taxonomy_result",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "taxonomy_result",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "nodeType": "Name",
                    "parts": [
                      "is_wp_error",
                    ],
                  },
                  "nodeType": "Expr_FuncCall",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "taxonomy_result",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation cache-priming",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:cache prime",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel cache:wp-post prime",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post_id",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "get_post",
                      ],
                    },
                    "nodeType": "Expr_FuncCall",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "class": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "WP_Post",
                      ],
                    },
                    "expr": {
                      "attributes": {},
                      "name": "post",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Instanceof",
                  },
                  "nodeType": "Expr_BooleanNot",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_load_failed",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Unable to load created Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 500,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "post",
                        "nodeType": "Expr_Variable",
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "request",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "name": "prepareBookResponse",
                    "nodeType": "Identifier",
                  },
                  "nodeType": "Expr_MethodCall",
                  "var": {
                    "attributes": {},
                    "name": "this",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Return",
              },
            ],
          },
        ],
      },
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:END AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
    ],
  },
]
`;

exports[`wp-post mutation route builders emits delete route body with previous response payload: delete-route 1`] = `
[
  {
    "attributes": {},
    "declares": [
      {
        "attributes": {},
        "key": {
          "attributes": {},
          "name": "strict_types",
          "nodeType": "Identifier",
        },
        "nodeType": "DeclareItem",
        "value": {
          "attributes": {},
          "nodeType": "Scalar_LNumber",
          "value": 1,
        },
      },
    ],
    "nodeType": "Stmt_Declare",
    "stmts": null,
  },
  {
    "attributes": {},
    "name": {
      "attributes": {},
      "nodeType": "Name",
      "parts": [
        "Demo",
        "Rest",
      ],
    },
    "nodeType": "Stmt_Namespace",
    "stmts": [
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:BEGIN AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
      {
        "attrGroups": [],
        "attributes": {},
        "extends": null,
        "flags": 0,
        "implements": [],
        "name": {
          "attributes": {},
          "name": "MutationHarness",
          "nodeType": "Identifier",
        },
        "namespacedName": null,
        "nodeType": "Stmt_Class",
        "stmts": [
          {
            "attrGroups": [],
            "attributes": {},
            "byRef": false,
            "flags": 0,
            "name": {
              "attributes": {},
              "name": "handle",
              "nodeType": "Identifier",
            },
            "nodeType": "Stmt_ClassMethod",
            "params": [],
            "returnType": null,
            "stmts": [
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "id",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "get_param",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "request",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "null",
                      ],
                    },
                    "nodeType": "Expr_ConstFetch",
                  },
                  "nodeType": "Expr_BinaryOp_Identical",
                  "right": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_missing_identifier",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Missing identifier for Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 400,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "id",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Cast_Int",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                  "nodeType": "Expr_BinaryOp_SmallerOrEqual",
                  "right": {
                    "attributes": {},
                    "nodeType": "Scalar_LNumber",
                    "value": 0,
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_invalid_identifier",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Invalid identifier for Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 400,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "id",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "resolveBookPost",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "class": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "WP_Post",
                      ],
                    },
                    "expr": {
                      "attributes": {},
                      "name": "post",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Instanceof",
                  },
                  "nodeType": "Expr_BooleanNot",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_not_found",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Book not found.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 404,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post",
                          "nodeType": "Expr_Variable",
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "request",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "prepareBookResponse",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "previous",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "ID",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_PropertyFetch",
                          "var": {
                            "attributes": {},
                            "name": "post",
                            "nodeType": "Expr_Variable",
                          },
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "nodeType": "Name",
                            "parts": [
                              "true",
                            ],
                          },
                          "nodeType": "Expr_ConstFetch",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "wp_delete_post",
                      ],
                    },
                    "nodeType": "Expr_FuncCall",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "deleted",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "false",
                      ],
                    },
                    "nodeType": "Expr_ConstFetch",
                  },
                  "nodeType": "Expr_BinaryOp_Identical",
                  "right": {
                    "attributes": {},
                    "name": "deleted",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_delete_failed",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Unable to delete Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 500,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "items": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "key": {
                        "attributes": {},
                        "nodeType": "Scalar_String",
                        "value": "deleted",
                      },
                      "nodeType": "Expr_ArrayItem",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": {
                          "attributes": {},
                          "nodeType": "Name",
                          "parts": [
                            "true",
                          ],
                        },
                        "nodeType": "Expr_ConstFetch",
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "key": {
                        "attributes": {},
                        "nodeType": "Scalar_String",
                        "value": "id",
                      },
                      "nodeType": "Expr_ArrayItem",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "expr": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "ID",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_PropertyFetch",
                          "var": {
                            "attributes": {},
                            "name": "post",
                            "nodeType": "Expr_Variable",
                          },
                        },
                        "nodeType": "Expr_Cast_Int",
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "key": {
                        "attributes": {},
                        "nodeType": "Scalar_String",
                        "value": "previous",
                      },
                      "nodeType": "Expr_ArrayItem",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "previous",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "nodeType": "Expr_Array",
                },
                "nodeType": "Stmt_Return",
              },
            ],
          },
        ],
      },
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:END AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
    ],
  },
]
`;

exports[`wp-post mutation route builders emits update route body with guarded status macro: update-route 1`] = `
[
  {
    "attributes": {},
    "declares": [
      {
        "attributes": {},
        "key": {
          "attributes": {},
          "name": "strict_types",
          "nodeType": "Identifier",
        },
        "nodeType": "DeclareItem",
        "value": {
          "attributes": {},
          "nodeType": "Scalar_LNumber",
          "value": 1,
        },
      },
    ],
    "nodeType": "Stmt_Declare",
    "stmts": null,
  },
  {
    "attributes": {},
    "name": {
      "attributes": {},
      "nodeType": "Name",
      "parts": [
        "Demo",
        "Rest",
      ],
    },
    "nodeType": "Stmt_Namespace",
    "stmts": [
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:BEGIN AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
      {
        "attrGroups": [],
        "attributes": {},
        "extends": null,
        "flags": 0,
        "implements": [],
        "name": {
          "attributes": {},
          "name": "MutationHarness",
          "nodeType": "Identifier",
        },
        "namespacedName": null,
        "nodeType": "Stmt_Class",
        "stmts": [
          {
            "attrGroups": [],
            "attributes": {},
            "byRef": false,
            "flags": 0,
            "name": {
              "attributes": {},
              "name": "handle",
              "nodeType": "Identifier",
            },
            "nodeType": "Stmt_ClassMethod",
            "params": [],
            "returnType": null,
            "stmts": [
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "id",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "get_param",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "request",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "null",
                      ],
                    },
                    "nodeType": "Expr_ConstFetch",
                  },
                  "nodeType": "Expr_BinaryOp_Identical",
                  "right": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_missing_identifier",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Missing identifier for Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 400,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "id",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Cast_Int",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": "id",
                    "nodeType": "Expr_Variable",
                  },
                  "nodeType": "Expr_BinaryOp_SmallerOrEqual",
                  "right": {
                    "attributes": {},
                    "nodeType": "Scalar_LNumber",
                    "value": 0,
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_invalid_identifier",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Invalid identifier for Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 400,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "id",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "resolveBookPost",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "class": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "WP_Post",
                      ],
                    },
                    "expr": {
                      "attributes": {},
                      "name": "post",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Instanceof",
                  },
                  "nodeType": "Expr_BooleanNot",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_not_found",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Book not found.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 404,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "items": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "key": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "ID",
                        },
                        "nodeType": "Expr_ArrayItem",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "ID",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_PropertyFetch",
                          "var": {
                            "attributes": {},
                            "name": "post",
                            "nodeType": "Expr_Variable",
                          },
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "key": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "post_type",
                        },
                        "nodeType": "Expr_ArrayItem",
                        "unpack": false,
                        "value": {
                          "args": [],
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "getBookPostType",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_MethodCall",
                          "var": {
                            "attributes": {},
                            "name": "this",
                            "nodeType": "Expr_Variable",
                          },
                        },
                      },
                    ],
                    "nodeType": "Expr_Array",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "post_data",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation status-validation",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:status normalise",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "status",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "get_param",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "request",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "status",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "null",
                      ],
                    },
                    "nodeType": "Expr_ConstFetch",
                  },
                  "nodeType": "Expr_BinaryOp_NotIdentical",
                  "right": {
                    "attributes": {},
                    "name": "status",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "expr": {
                        "args": [
                          {
                            "attributes": {},
                            "byRef": false,
                            "name": null,
                            "nodeType": "Arg",
                            "unpack": false,
                            "value": {
                              "attributes": {},
                              "name": "status",
                              "nodeType": "Expr_Variable",
                            },
                          },
                        ],
                        "attributes": {},
                        "name": {
                          "attributes": {},
                          "name": "normaliseBookStatus",
                          "nodeType": "Identifier",
                        },
                        "nodeType": "Expr_MethodCall",
                        "var": {
                          "attributes": {},
                          "name": "this",
                          "nodeType": "Expr_Variable",
                        },
                      },
                      "nodeType": "Expr_Assign",
                      "var": {
                        "attributes": {},
                        "dim": {
                          "attributes": {},
                          "nodeType": "Scalar_String",
                          "value": "post_status",
                        },
                        "nodeType": "Expr_ArrayDimFetch",
                        "var": {
                          "attributes": {},
                          "name": "post_data",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    },
                    "nodeType": "Stmt_Expression",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "post_data",
                          "nodeType": "Expr_Variable",
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "nodeType": "Name",
                            "parts": [
                              "true",
                            ],
                          },
                          "nodeType": "Expr_ConstFetch",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "wp_update_post",
                      ],
                    },
                    "nodeType": "Expr_FuncCall",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "result",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "result",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "nodeType": "Name",
                    "parts": [
                      "is_wp_error",
                    ],
                  },
                  "nodeType": "Expr_FuncCall",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "result",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "left": {
                    "attributes": {},
                    "nodeType": "Scalar_LNumber",
                    "value": 0,
                  },
                  "nodeType": "Expr_BinaryOp_Identical",
                  "right": {
                    "attributes": {},
                    "name": "result",
                    "nodeType": "Expr_Variable",
                  },
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_update_failed",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Unable to update Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 500,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation sync-meta",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:meta update",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": {
                          "attributes": {},
                          "name": "ID",
                          "nodeType": "Identifier",
                        },
                        "nodeType": "Expr_PropertyFetch",
                        "var": {
                          "attributes": {},
                          "name": "post",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "request",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "name": "syncBookMeta",
                    "nodeType": "Identifier",
                  },
                  "nodeType": "Expr_MethodCall",
                  "var": {
                    "attributes": {},
                    "name": "this",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation sync-taxonomies",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:taxonomies update",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "ID",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_PropertyFetch",
                          "var": {
                            "attributes": {},
                            "name": "post",
                            "nodeType": "Expr_Variable",
                          },
                        },
                      },
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": "request",
                          "nodeType": "Expr_Variable",
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "name": "syncBookTaxonomies",
                      "nodeType": "Identifier",
                    },
                    "nodeType": "Expr_MethodCall",
                    "var": {
                      "attributes": {},
                      "name": "this",
                      "nodeType": "Expr_Variable",
                    },
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "taxonomy_result",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "taxonomy_result",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "nodeType": "Name",
                    "parts": [
                      "is_wp_error",
                    ],
                  },
                  "nodeType": "Expr_FuncCall",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "attributes": {},
                      "name": "taxonomy_result",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel resource.wpPost.mutation cache-priming",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel mutation:cache prime",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {
                  "comments": [
                    {
                      "nodeType": "Comment",
                      "text": "// @wp-kernel cache:wp-post prime",
                    },
                  ],
                },
                "nodeType": "Stmt_Nop",
              },
              {
                "attributes": {},
                "expr": {
                  "attributes": {},
                  "expr": {
                    "args": [
                      {
                        "attributes": {},
                        "byRef": false,
                        "name": null,
                        "nodeType": "Arg",
                        "unpack": false,
                        "value": {
                          "attributes": {},
                          "name": {
                            "attributes": {},
                            "name": "ID",
                            "nodeType": "Identifier",
                          },
                          "nodeType": "Expr_PropertyFetch",
                          "var": {
                            "attributes": {},
                            "name": "post",
                            "nodeType": "Expr_Variable",
                          },
                        },
                      },
                    ],
                    "attributes": {},
                    "name": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "get_post",
                      ],
                    },
                    "nodeType": "Expr_FuncCall",
                  },
                  "nodeType": "Expr_Assign",
                  "var": {
                    "attributes": {},
                    "name": "updated",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Expression",
              },
              {
                "attributes": {},
                "cond": {
                  "attributes": {},
                  "expr": {
                    "attributes": {},
                    "class": {
                      "attributes": {},
                      "nodeType": "Name",
                      "parts": [
                        "WP_Post",
                      ],
                    },
                    "expr": {
                      "attributes": {},
                      "name": "updated",
                      "nodeType": "Expr_Variable",
                    },
                    "nodeType": "Expr_Instanceof",
                  },
                  "nodeType": "Expr_BooleanNot",
                },
                "else": null,
                "elseifs": [],
                "nodeType": "Stmt_If",
                "stmts": [
                  {
                    "attributes": {},
                    "expr": {
                      "args": [
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "wpk_book_load_failed",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "nodeType": "Scalar_String",
                            "value": "Unable to load updated Book.",
                          },
                        },
                        {
                          "attributes": {},
                          "byRef": false,
                          "name": null,
                          "nodeType": "Arg",
                          "unpack": false,
                          "value": {
                            "attributes": {},
                            "items": [
                              {
                                "attributes": {},
                                "byRef": false,
                                "key": {
                                  "attributes": {},
                                  "nodeType": "Scalar_String",
                                  "value": "status",
                                },
                                "nodeType": "Expr_ArrayItem",
                                "unpack": false,
                                "value": {
                                  "attributes": {},
                                  "nodeType": "Scalar_LNumber",
                                  "value": 500,
                                },
                              },
                            ],
                            "nodeType": "Expr_Array",
                          },
                        },
                      ],
                      "attributes": {},
                      "class": {
                        "attributes": {},
                        "nodeType": "Name",
                        "parts": [
                          "WP_Error",
                        ],
                      },
                      "nodeType": "Expr_New",
                    },
                    "nodeType": "Stmt_Return",
                  },
                ],
              },
              {
                "attributes": {},
                "expr": {
                  "args": [
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "updated",
                        "nodeType": "Expr_Variable",
                      },
                    },
                    {
                      "attributes": {},
                      "byRef": false,
                      "name": null,
                      "nodeType": "Arg",
                      "unpack": false,
                      "value": {
                        "attributes": {},
                        "name": "request",
                        "nodeType": "Expr_Variable",
                      },
                    },
                  ],
                  "attributes": {},
                  "name": {
                    "attributes": {},
                    "name": "prepareBookResponse",
                    "nodeType": "Identifier",
                  },
                  "nodeType": "Expr_MethodCall",
                  "var": {
                    "attributes": {},
                    "name": "this",
                    "nodeType": "Expr_Variable",
                  },
                },
                "nodeType": "Stmt_Return",
              },
            ],
          },
        ],
      },
      {
        "attributes": {
          "comments": [
            {
              "nodeType": "Comment",
              "text": "// WPK:END AUTO",
            },
          ],
        },
        "nodeType": "Stmt_Nop",
      },
    ],
  },
]
`;
